---
title: "The Next Generation of Canadian Salmon"
subtitle: "The Effects of the Commercial Fishing Industry on Spawning Rates"
author: 
  - Timothius Prajogi
thanks: "Code and data are available at: https://github.com/prajogt/canadian_salmon_spawn.git ."
date: today
date-format: long
abstract: "Using the NuSEDS dataset and Catch Estimates for the Pacific Region Commerical Salmon Fishery dataset provided by the Government of Canada, we investigate the effects of commercial fishing on the reproductive capacity of Canadian Salmon. Along with that, we can infer how much of the change in spawn rates can be therefore attributed to the health of the ecosystem, climate, and the fish that live in it. This paper discusses the impact of direct human intervention in the form of commercial fishing, aiming to highlight the importance in proper management and control in the fishing industry in alignement with changes in the environment by predicting spawning trends of future generations."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
header-includes:
  \usepackage{placeins}
---

```{r}
#| include: false
#| warning: false
#| message: false
#| echo: false

#### Workspace setup ####
library(knitr)
library(tidyverse)
library(modelsummary)
library(rstanarm)
library(arrow)
```

# Introduction

The declining trend in Canadian salmon runs, as observed by many avid anglers and supported by empirical data [@citedecline], serves as the focal point of this paper. Once thriving waterways have experienced a significant reduction in salmon populations, posing challenges not only for recreational anglers but also for the fishing industry, a vital component of Canadian exports and numerous livelihoods, particularly in coastal regions. Due to this significance to many Canadians, it is important to investigate the decline in salmon runs, highlighting the importance of understanding and addressing these challenges that are faced in the effort to safeguard future salmon generations.

This paper will focus on commercial fishing trends, ocean climate trends, and spawning rates over the last decade, using datasets and fisheries statistics provided through the Government of Canada's open data portal. In particular, the NuSEDS (New Salmon Escapement Database System) provides key insights on spawn records and abundance estimates for freshwater streams and tributaries, with statistics provided by Fisheries and Oceans Canada providing detail on the amount of fish landed or released through commercial fishing methods by species. Through this data we discover the potential human-induced drivers of salmon population change including factors such as over fishing and artificial breeding. In identifying the critical areas for repair and reform, we aim to explore potential mitigation strategies and management plans with the goal of restoring salmon populations and promoting sustainable fishing practices, protecting this key resource. Preserving healthy salmon populations is not only essential for maintaining biodiversity and ecosystem balance but also for meeting demand required of this industry, both in labour and in product. 

Through information gathered from these datasets, we were able to verify correlations between the frequency of fishing and the salmon population, as well as the previous years salmon population and artificial breeding practices affect on future generations. However, although these are significant factors, they do not account for all the change that is seen throughout the years. Salmon population's fluctuation cannot be fully explained by these human factors alone, which means there must be some other factors that are not described in this data that should be investigated. 

This paper will introduce the data and models we used to analyze these themes and trends, explaining why features and datasets were chosen and how they are relevant to the research topic. The models we create will use commercial fisheries' catch estimates and past years artificial and natural spawn success respectively as the estimands to predict salmon populations. Then the paper will present our findings and their implications for future salmon generations observed in the models that were created as well as in the data. We will conclude by discussing the weaknesses and future steps that could be made to further improve on this research.

# Data {#data}

The data used in this paper was provided by the Government of Canada through their Open Government Portal, published by Fisheries and Oceans Canada. This portal provided other datasets relating to salmon health / population, however, the datasets selected are consistently updated and provide relevant as well as historical data that is useful when researching yearly trends which salmon populations are due to the fact that future populations are largely impacted by the success of each year's spawn. 

## Spawn

For information regarding the populations of Canadian Salmon in the Pacific region, the *New Salmon Escapement Database System (NuSEDS)* [@citenuseds] was used to retrieve the quality and health of the Salmon population. This data is not only used to measure the populations but other health and success measures that certain area salmon have. These observations are made during the spawning season for salmon (from September - November), recording the amount of salmon that have come to spawn in a certain waterbody. As it is not possible for those wildlife officials to individually count each salmon that enters a waterway at any time during the day, an estimated count was made based on the abundance of salmon currently present during the observation.

The database provides salmon spawning observations starting from 1920's, but population numbers were not recorded / provided until 1979. As such, rows not providing population numbers were not considered. In addition, for each model, specific features were necessary to create the model, and the original dataset was split into two models, each only containing the entries that include relevant information. 

```{r}
#| include: false
#| warning: false
#| message: false
#| echo: false

# Load in data

# Catch data
gill_net_catches <- read_parquet("data/gill_net_catches.parquet")
seine_catches <- read_parquet("data/seine_catches.parquet")
troll_catches <- read_parquet("data/troll_catches.parquet")

# Spawn data
spawning_population <- read_parquet("data/spawning_population.parquet")
broodstock <- read_parquet("data/broodstock.parquet")

```

```{r, table, width="100%"}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-spawnpopulation
#| tbl-cap: "NuSEDS Data on Spawning Population"

spawning_population |>
    select(-LOCAL_NAME, -NATURAL_SPAWNERS_TOTAL) |>
    head() |>
    kable(
      col.names = c("Area", "Name of Waterbody", "Year", "Species", "Natural Adult Spawners", "Natural Jack Spawners", "Total Return To River"),
      booktabs = TRUE
    )
```


```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-broodstock
#| tbl-cap: "NuSEDS Data on Broodstock and Population"

broodstock |>
  select(-NATURAL_ADULT_SPAWNERS, -NATURAL_SPAWNERS_TOTAL, -TOTAL_BROODSTOCK_REMOVALS) |>
  filter(ADULT_BROODSTOCK_REMOVALS > 0) |> # For the sack of the visual
  head() |>
  kable(
    col.names = c("Area", "Name of Waterbody", "Year", "Species", "Adult Broodstock Removals", "Jack Broodstock Removals", "Other Removals", "Total Return To River"),
    booktabs = TRUE
  )
```

The most important part of this dataset that we consider is the spawning salmon population observed at various waterways as shown in @tbl-spawnpopulation. We then also consider the broodstock removal statistics in @tbl-broodstock, which is the amount of salmon that were removed for the purposes of artificial breeding. These salmon's progeny are later released back into the wild.

Variables for both @tbl-spawnpopulation and @tbl-broodstock:

Waterbody + Area + Year:

  -   This defines the waterbody and the general management area that this observation came from, and what year that observation was made. I have provided the map that shows the actual geographical area that an area code signifies.

Species:

  -   This defines the species of salmon that the observation was made for. Observations were made for Sockeye, Chum, Pink, chinook, Coho, Steelhead, Atlantic, and Kokanee salmon, but only observations for the more common salmon species were made. (Sockeye, Chum, Pink, Chinook, and Coho) These are the salmon that make up the vast majority of the sport and the commercial market, which is the focus of this paper, and why the other salmon observations were not considered.

Total Return to River:

  -   This defines the total amount of salmon of that species that was observed in that waterbody, being number of natural spawners + number of non-natural spawners (fish released / cultivated by the government to support salmon population). For @tbl-spawnpopulation, an N/A value indicates that only natural spawners were observed.

Variables for @tbl-spawnpopulation:

Natural Adult Spawners:

  -   These are the amount of salmon observed that have reached maturity.

Natural Jack Spawners:

  -   These are fish that have matured at an early age, and are much smaller than the adult spawners. When the value is N/A this indicates that no jacks were not observed.

Variables for @tbl-broodstock:

Adult Broodstock Removals:

  -   Similarly to the spawning population data, these are the amount of mature salmon that were removed from the waterbody for the purposes of breeding.

Jack Broodstock Removals:

  -   Similarly to the spawning population data, these are the amount of jack salmon that were removed from the waterbody for the purposes of breeding.

Other Removals:

  -   These are the amount of salmon that were removed from their natural environment by humans for other reasons (not broodstock) which were not defined by the dataset. 

## Catch

For information regarding the salmon caught in commercial fisheries, the *Pacific Region Commercial Salmon Fishery In-season Catch Estimates* [@citecatch] was used. This data comes from the Fishery Operations System (FOS) which serves as the primary database for Fisheries and Oceans Canada's (DFO) Pacific Region Commercial Salmon Logbook program, established in 1998 and mandated fleet-wide participation by 2001. This program compels commercial salmon fishers to log daily catch and effort data in harvest logbooks, subsequently reporting it to DFO via service providers within specified deadlines. However, certain personal information provided by fishers is protected and inaccessible. Fishery Managers utilize this reported data, alongside additional sources like overflights, to compute in-season catch estimates. Its important to note that this dataset omits data from test fishing, recreational fishing, or First Nations harvest.


```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-catchdata_gill
#| tbl-cap: "Commercial Salmon Fishing Catch Estimates from 2005 - 2022 from Gill Net Fisheries"

gill_net_catches |>
  select(CALENDAR_YEAR, MGMT_AREA, VESSEL_COUNT, BOAT_DAYS, SOCKEYE_KEPT, SOCKEYE_RELD) |>
  head() |>
  kable(
    col.names = c("Year", "Management Area", "Vessel Count", "Boat Days", "Sockeye Kept", "Sockeye Released"),
    booktabs = TRUE
  )
```

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-catchdata_seine
#| tbl-cap: "Commercial Salmon Fishing Catch Estimates from 2005 - 2022 from Seine Net Fisheries"

seine_catches |>
  select(CALENDAR_YEAR, MGMT_AREA, VESSEL_COUNT, BOAT_DAYS, SOCKEYE_KEPT, SOCKEYE_RELD) |>
  head() |>
  kable(
    col.names = c("Year", "Management Area", "Vessel Count", "Boat Days", "Sockeye Kept", "Sockeye Released"),
    booktabs = TRUE
  )
```

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-catchdata_troll
#| tbl-cap: "Commercial Salmon Fishing Catch Estimates from 2005 - 2022 from Trolling Fisheries"

troll_catches |>
  select(CALENDAR_YEAR, MGMT_AREA, VESSEL_COUNT, BOAT_DAYS, SOCKEYE_KEPT, SOCKEYE_RELD) |>
  head() |>
  kable(
    col.names = c("Year", "Management Area", "Vessel Count", "Boat Days", "Sockeye Kept", "Sockeye Released"),
    booktabs = TRUE
  )
```

This dataset is provided in three parts, separated by the type of commercial fishing that was being tracked. The three types being: Gill nets, Seine nets, and Trolling.

**Gill Nets**

  -   These are vertical panels of netting suspended in the water by a float line and a weighted line. Fish swimming into the net become entangled by their gills as they attempt to pass through the mesh. Gill nets are often set in a stationary position and left for a period of time before retrieval.

**Seine Nets**

  -   Seine nets are large, horizontal nets deployed from the side of a vessel. They typically have floats along the top edge and weights along the bottom to create a wall of netting that can be drawn in a circular motion to encircle fish. Once the fish are contained within the net, it is hauled in and the catch is retrieved.

**Trolling**

  -   Trolling involves trailing baited fishing lines behind a moving vessel. The lines are attached to fishing rods or reels and are drawn through the water at varying depths and speeds. This method allows fishermen to target specific species of fish by adjusting the depth and speed of the trolling lines.

Understanding the type of fishing method used is crucial because each method has different impacts on salmon populations. For example:

- Gill nets are known for their high selectivity, catching fish primarily by their gills. However, they can also unintentionally catch non-target species and may lead to bycatch issues.

- Seine nets are effective for catching large quantities of fish in a single haul, but they may have a significant impact on fish habitat and can result in the incidental capture of non-target species.

- Trolling is often considered a more sustainable fishing method compared to nets because it allows for the release of non-target species and reduces habitat damage. However, it can still have localized impacts on salmon populations if not properly managed.

By categorizing the dataset based on the type of commercial fishing method, we can better understand the specific impacts of each method on salmon populations and inform fisheries management decisions accordingly.

For each of @tbl-catchdata_gill, @tbl-catchdata_seine, @tbl-catchdata_troll, we consider the following variables:

Year + Management Area:

- Similarly to @tbl-spawnpopulation, this signifies the year and area the catch estimates were made for. However in this case the management area is different to the area mentioned prior. It also refers to a region, however this time it refers to the area that a fish was caught in.

- Regarding this field, it was originally intended to be used to match up certain fishing regions to certain spawning regions. However, since it is not guaranteed or even expected that salmon stay close to their spawning grounds during the open fishing season, these area fields were not used in this matter. They do still have value that is not used in this report, as will be mentioned in the [discussion](#discussion) section.

Vessel Count:

- This measures the amount of vessels fishing in a certain management area in the year.

Boat Days:

- This measures the total amount of days that each vessel was fishing in that management area. For instance if there were two vessels fishing for the same two days each, that would be 4 boat days.

Salmon Species Kept:

- These are the amount of salmons of that particular species indicated in the column name were kept from that management area in that year.

- Although @tbl-catchdata_gill, @tbl-catchdata_seine, and @tbl-catchdata_troll only show sockeye kept, the catch estimates for all other salmon species are also present, they were omitted here due for simplicity.

Salmon Species Released:

- These are the amount of salmons of that particular species indicated in the column name were caught but not kept and released back into the water from that management area in that year.

- Although @tbl-catchdata_gill, @tbl-catchdata_seine, and @tbl-catchdata_troll only show sockeye kept, the catch estimates for all other salmon species are also present, they were omitted here due for simplicity.

```{r}
# TODO show all the relationships (broodstock vs population, total catches vs population, type vs population)
```

This data was downloaded, cleaned, parsed, analyzed, and visualized using R [@citeR], a statistical programming language, with package support from `tidyverse` [@citetidyverse], a collection of libraries which included the following packages that were utilized:

-   `ggplot2` [@citeggplot]
-   `dplyr` [@citedplyr]
-   `readr` [@citereadr]
-   `tibble` [@citetibble]

For additional assistance with data storage, the `arrow` [@citearrow] was used and for report generation, the `knitr` [@citeknitr] package was used.


# Model

To create the linear model we made use of the `rstanarm` [@citerstanarm] package, and to summarize the results we made use of the `modelsummary` [@citemodelsummary] package.

In particular we aim to predict salmon populations based on commercial fishing habits and previous year's spawning health.

```{r}
#| include: false
#| warning: false
#| message: false
#| echo: false

# Load in models
yearly_change_model <-
  readRDS(file = "models/yearly_change_model.rds")

catch_population_model <-
  readRDS(file = "models/catch_population_model.rds")

```

## Catch Model

The first model that was created was intended to discover whether the amount of fish harvested through commercial fisheries and the amount of vessels actively harvesting significantly impacted salmon population in Pacific Canada.

We expect that an increase in the amount of fish harvested would impact the population, so we aim to ensure that commercial fishing was and will be done in a controlled and sustainable way. Here we are really testing the effectiveness of fishing regulations and license allocations that the Canadian government has put in place to protect salmon populations.

Therefore the model we are interested in is:

$$
\begin{aligned}
&\mbox{salmon-population}_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \beta_0 +\beta_1\mbox{vessel-count}_i +\beta_2\mbox{boat-days}_i \\
& +\beta_3\mbox{salmon-kept}_i +\beta_4\mbox{salmon-released}_i\\
& +\beta_5\mbox{percentage-gill-net}_i +\beta_6\mbox{percentage-seine}_i\\
& +\beta_7\mbox{percentage-troll}_i\\
\beta_{0, 1, ... 7} &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1) \\
\end{aligned}
$$

`salmon-population`, `vessel-count`, `boat-days`, `salmon-kept` and `salmon-released` are all as they were in @tbl-catchdata_gill, @tbl-catchdata_seine, and @tbl-catchdata_troll, accounting for the frequency and quantity of harvest.

`percentage-gill-net`, `seine`, and `troll` account for how much of the total amount of salmon harvested came from that respective method, since all salmon species and fishing methods were aggregated as mentioned in the [data](#data) section.

These variables are included to see if certain methods of fishing have a greater or lesser effect on the salmon population.

@tbl-catchmodel shows a model summary for this model, this will be discussed further in the [results](#results) section.

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: tbl-catchmodel
#| tbl-cap: "Predicting the Salmon Population given commercial fishing catch estimates"

modelsummary(
  list(
    "Salmon Population" = catch_population_model
  ),
  statistic = "mad"
  )

```

## Yearly Model

The second model uses past year's spawning data to predict the next year's populations. It is reasonable to expect that bad spawning rates one year can affect future year's spawning rates. With NOAA stating that the most common age of returning and spawning adults being 4 years old [@citelifespan], the predicted variable is the salmon populations observed 4 years in the future. 

There are also 2 types of spawning data as shown in @tbl-broodstock vs @tbl-spawnpopulation, being natural vs human cultivated, so the model takes into account those factors, aiming to see the the natural sustainability of salmon populations as well as the impact of protected and selective breeding on those populations.

Therefore the model we are interested in is:

$$
\begin{aligned}
&\mbox{next-year-salmon-population}_i|\mu_i, \sigma \sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \beta_0 +\beta_1\mbox{adult-broodstock-removals}_i +\beta_2\mbox{jack-broodstock-removals}_i \\
& +\beta_3\mbox{total-broodstock-removals}_i +\beta_4\mbox{other-removals}_i\\
& +\beta_5\mbox{total-return-to-river}_i \\
\beta_{0, 1, ... 5} &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1) \\
\end{aligned}
$$

Where the variables are defined the same way as mentioned when discussing @tbl-broodstock and @tbl-spawnpopulation, with the except to `next-year-salmon-population`, which is the population of salmon 4 years after a certain observation was made as mentioned above.

@tbl-yearlymodel shows a model summary for this model, this will be discussed in the [results](#results) section.

```{r}
#| message: false
#| warning: false
#| echo: false
#| label: tbl-yearlymodel
#| tbl-cap: "Predicting the Salmon Population in 4 years time given a year's spawn statistics"

modelsummary(
  list(
    "Salmon Population" = yearly_change_model
  ),
  statistic = "mad"
  )

```

# Results {#results}

# Discussion {#discussion}

```{r}
# TODO talk about the fact that region caught vs population count region were not considered,
# to be more accuracte, we would monitor changes between each watershed

# Talk about the large amount of na values, population may not be accurately represented in some years
```

# References

